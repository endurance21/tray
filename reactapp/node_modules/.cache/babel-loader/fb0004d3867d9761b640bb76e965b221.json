{"ast":null,"code":"var _jsxFileName = \"/home/endurance21/tray/reactapp/src/views/orders/index.js\";\nimport React from 'react';\nimport Styles from './main.module.css';\nimport ChooseCanteen from '../canteens/chooseCanteen';\nimport { BrowserRouter as Router, Route } from 'react-router-dom';\nimport Item from '../items/index';\nimport Member from '../member/index';\nimport Order from '../order/index';\n\nvar axios = require('axios');\n\nvar canteen_id = '';\nvar order_name = '';\nvar object = [];\nvar order_hash = '';\nvar order_id = '';\nvar members = [];\nvar orders = [];\nvar numberOfSubmit = 0; // var orderHas\n\nexport default class OrderPage extends React.Component {\n  constructor(props) {\n    super();\n\n    this.setCanteenId = value => {\n      canteen_id = value;\n      console.log(value);\n      this.setState({\n        canteenId: value\n      });\n      console.log(this.state.canteenId);\n    };\n\n    this.update = (update, itemId) => {\n      object[itemId - 1].quantity = update + 1;\n      console.log(object);\n    };\n\n    this.setOrderName = value => {\n      order_name = value;\n      console.log(order_name);\n      this.setState({\n        orderName: value\n      });\n    };\n\n    this.createOrder = () => {\n      console.log(canteen_id);\n      let user = JSON.parse(localStorage.getItem('user'));\n      let groups = JSON.parse(localStorage.getItem('groups'));\n      let url = \"http://localhost:3005/api/orders/create\";\n      console.log(order_name);\n      let data = {\n        order_name: order_name,\n        user_id: user.userId,\n        group_code: groups.groupcode,\n        canteen_id: canteen_id,\n        item_id: 0\n      };\n      console.log(data);\n      axios.post(url, data).then(res => {\n        console.log(res.data);\n        order_hash = res.data.order_hash;\n        console.log(order_hash);\n        this.fetchItems();\n      });\n    };\n\n    this.fetchItems = () => {\n      console.log(\"fetch items\");\n      let url = \"http://localhost:3005/api/canteens/\" + \"rajeev_item_list\";\n      let data = {\n        canteen_id: canteen_id + 1\n      };\n      axios.get(url).then(res => {\n        // console.log(res);\n        for (let i = 0; i < res.data.length; i++) {\n          object.push({\n            item_id: res.data[i].item_id,\n            item_name: res.data[i].item_name,\n            item_price: res.data[i].item_price,\n            quantity: 0\n          });\n          this.setState({\n            items: object.map((object, index) => React.createElement(Item, {\n              itemId: object.item_id,\n              price: object.item_price,\n              description: object.item_name,\n              update: this.update,\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 113\n              },\n              __self: this\n            }))\n          });\n        }\n      });\n      this.fetchMembers();\n      this.fetchOrders();\n    };\n\n    this.getOrderId = () => {};\n\n    this.deleteItem = () => {};\n\n    this.submit = () => {\n      console.log(order_id);\n      numberOfSubmit++;\n      let user = JSON.parse(localStorage.getItem('user'));\n      let deleteurl = \"http://localhost:3005/api/orders/deleteitem\";\n      if (numberOfSubmit > 1) object.map((item, index) => {\n        let data = {\n          order_id: order_id,\n          user_id: user.userId,\n          canteen_id: canteen_id,\n          item_id: index + 1\n        };\n        axios.post(deleteurl, data).then(res => {\n          console.log(res.data);\n        });\n      });\n      this.setState({\n        myorders: object.map((item, index) => React.createElement(\"li\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 158\n          },\n          __self: this\n        }, \" \", item.item_name, \" :\", item.quantity))\n      });\n      let url = \"http://localhost:3005/api/orders/additem\"; //  this.getOrderId();\n\n      let url2 = \"http://localhost:3005/api/order/orderId\";\n      let data = {\n        order_hash: order_hash\n      };\n      let url3 = \"http://localhost:3005/api/orders/delete//'\";\n      axios.post(url2, data).then(res => {\n        order_id = res.data[0].order_id;\n        object.map((item, index) => {\n          let data = {\n            order_id: order_id,\n            user_id: user.userId,\n            canteen_id: canteen_id,\n            item_id: index + 1,\n            quantity: item.quantity\n          };\n          axios.post(url, data).then(res => {\n            console.log(res.data);\n          });\n        });\n      });\n    };\n\n    this.fetchMembers = () => {\n      // this.setState({\n      //     members:''\n      // })\n      members = [];\n      let url = \"http://localhost:3005/api/getgroupid2\";\n      let group_code = JSON.parse(localStorage.getItem('groups')).groupcode;\n      let data = {\n        group_code: group_code\n      };\n      console.log(group_code);\n      axios.post(url, data).then(res => {\n        console.log(res);\n        let group_id = res.data.group_id;\n        let url = \"http://localhost:3005/api/getmembers\";\n        let data = {\n          group_id: group_id\n        };\n        console.log(group_id);\n        axios.post(url, data).then(res => {\n          console.log(res.data);\n\n          for (let i = 0; i < res.data.length; i++) {\n            members.push({\n              member_id: res.data[i].member_id\n            });\n            this.setState({\n              members: members.map((member, index) => React.createElement(Member, {\n                memberId: member.member_id,\n                __source: {\n                  fileName: _jsxFileName,\n                  lineNumber: 221\n                },\n                __self: this\n              }))\n            });\n          }\n        });\n      });\n    };\n\n    this.updateList = () => {\n      this.fetchMembers();\n    };\n\n    this.updateOrderList = () => {\n      this.fetchOrders();\n    };\n\n    this.fetchOrders = () => {\n      orders = [];\n      console.log(\"fetch order\");\n      let url2 = \"http://localhost:3005/api/order/orderId\";\n      let data = {\n        order_hash: order_hash\n      };\n      console.log(data);\n      axios.post(url2, data).then(res => {\n        console.log(res.data);\n        order_id = res.data[0].order_id;\n        console.log(order_id);\n        let url = \"http://localhost:3005/api/getorders\";\n        let data = {\n          order_id: order_id\n        };\n        axios.post(url, data).then(res => {\n          console.log(res.data);\n\n          for (let i = 0; i < res.data.length; i++) {\n            orders.push({\n              user_id: res.data[i].user_id,\n              item_id: res.data[i].item_id,\n              quantity: res.data[i].quantity\n            });\n            this.setState({\n              orderList: orders.map((order, index) => React.createElement(Order, {\n                user_id: order.user_id,\n                item_id: order.item_id,\n                quantity: order.quantity,\n                __source: {\n                  fileName: _jsxFileName,\n                  lineNumber: 267\n                },\n                __self: this\n              }))\n            });\n          }\n        });\n      });\n    };\n\n    this.leaveGroup = () => {\n      let url = \"http://localhost:3005/api/leavegroup\";\n      let user = JSON.parse(localStorage.getItem('user'));\n      let data = {\n        member_id: user.userId\n      };\n      axios.posttt;\n    };\n\n    console.log(props);\n    this.state = {\n      canteenId: '',\n      orderName: '',\n      myorders: '',\n      members: '',\n      orderList: ''\n    };\n  }\n\n  componentDidMount() {}\n\n  render() {\n    // console.log(this.state.members)\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 285\n      },\n      __self: this\n    }, React.createElement(Router, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 286\n      },\n      __self: this\n    }, React.createElement(Route, {\n      path: \"/orderPage\",\n      exact: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 287\n      },\n      __self: this\n    }, React.createElement(ChooseCanteen, {\n      setCanteenId: this.setCanteenId,\n      setOrderName: this.setOrderName,\n      createOrder: this.createOrder,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 288\n      },\n      __self: this\n    }), this.state.canteenId ? this.state.canteenId : '', this.state.orderName ? this.state.orderName : ''), React.createElement(Route, {\n      path: \"/orderPage/order\",\n      exact: true,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 293\n      },\n      __self: this\n    }, this.props.groupCode ? React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 295\n      },\n      __self: this\n    }, \"YOUR GROUP CODE IS : \", this.props.groupCode) : '', React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 297\n      },\n      __self: this\n    }, \" your ORDER NAME IS : \", order_name), React.createElement(\"div\", {\n      className: Styles.myorders,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 299\n      },\n      __self: this\n    }, \"YOUR final Order\", this.state.myorders), React.createElement(\"div\", {\n      className: Styles.members,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 304\n      },\n      __self: this\n    }, React.createElement(\"button\", {\n      className: Styles.submit,\n      onClick: this.updateList,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 305\n      },\n      __self: this\n    }, \"update\"), React.createElement(\"h3\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 307\n      },\n      __self: this\n    }, \"Members List:\"), this.state.members), React.createElement(\"div\", {\n      className: Styles.itemList,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 310\n      },\n      __self: this\n    }, \":::::::CHOOSE YOUR ITEMS ::::::::\", React.createElement(\"ul\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 312\n      },\n      __self: this\n    }, this.state.items)), React.createElement(\"button\", {\n      className: Styles.submit,\n      onClick: this.submit,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 317\n      },\n      __self: this\n    }, \"SUBMIT MY ORDER\"), React.createElement(\"div\", {\n      className: Styles.orderList,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 318\n      },\n      __self: this\n    }, React.createElement(\"button\", {\n      className: Styles.submit,\n      onClick: this.updateOrderList,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 319\n      },\n      __self: this\n    }, \"update\"), \"::::ALL ORDERS ::::::\", this.state.orderList)), React.createElement(\"button\", {\n      className: Styles.submit,\n      onClick: this.leaveGroup,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 326\n      },\n      __self: this\n    }, \"update\")));\n  }\n\n}","map":{"version":3,"sources":["/home/endurance21/tray/reactapp/src/views/orders/index.js"],"names":["React","Styles","ChooseCanteen","BrowserRouter","Router","Route","Item","Member","Order","axios","require","canteen_id","order_name","object","order_hash","order_id","members","orders","numberOfSubmit","OrderPage","Component","constructor","props","setCanteenId","value","console","log","setState","canteenId","state","update","itemId","quantity","setOrderName","orderName","createOrder","user","JSON","parse","localStorage","getItem","groups","url","data","user_id","userId","group_code","groupcode","item_id","post","then","res","fetchItems","get","i","length","push","item_name","item_price","items","map","index","fetchMembers","fetchOrders","getOrderId","deleteItem","submit","deleteurl","item","myorders","url2","url3","group_id","member_id","member","updateList","updateOrderList","orderList","order","leaveGroup","posttt","componentDidMount","render","groupCode","itemList"],"mappings":";AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,MAAP,MAAmB,mBAAnB;AACA,OAAOC,aAAP,MAA0B,2BAA1B;AACA,SAAQC,aAAa,IAAIC,MAAzB,EAAmCC,KAAnC,QAA+C,kBAA/C;AACA,OAAOC,IAAP,MAAiB,gBAAjB;AACA,OAAOC,MAAP,MAAmB,iBAAnB;AACA,OAAOC,KAAP,MAAkB,gBAAlB;;AACA,IAAIC,KAAK,GAAIC,OAAO,CAAC,OAAD,CAApB;;AAEA,IAAIC,UAAU,GAAG,EAAjB;AACA,IAAIC,UAAU,GAAG,EAAjB;AACA,IAAIC,MAAM,GAAG,EAAb;AACA,IAAIC,UAAU,GAAG,EAAjB;AACA,IAAIC,QAAQ,GAAG,EAAf;AACA,IAAIC,OAAO,GAAG,EAAd;AACA,IAAIC,MAAM,GAAG,EAAb;AACA,IAAIC,cAAc,GAAG,CAArB,C,CACA;;AACA,eAAe,MAAMC,SAAN,SAAwBnB,KAAK,CAACoB,SAA9B,CAAuC;AAClDC,EAAAA,WAAW,CAACC,KAAD,EAAO;AACd;;AADc,SAgBlBC,YAhBkB,GAgBFC,KAAD,IAAS;AAEpBb,MAAAA,UAAU,GAAGa,KAAb;AACAC,MAAAA,OAAO,CAACC,GAAR,CAAYF,KAAZ;AACA,WAAKG,QAAL,CAAc;AACVC,QAAAA,SAAS,EAACJ;AADA,OAAd;AAIAC,MAAAA,OAAO,CAACC,GAAR,CAAY,KAAKG,KAAL,CAAWD,SAAvB;AAEH,KA1BiB;;AAAA,SA4BlBE,MA5BkB,GA4BT,CAACA,MAAD,EAASC,MAAT,KAAkB;AAInBlB,MAAAA,MAAM,CAACkB,MAAM,GAAC,CAAR,CAAN,CAAiBC,QAAjB,GAA4BF,MAAM,GAAG,CAArC;AAEAL,MAAAA,OAAO,CAACC,GAAR,CAAYb,MAAZ;AACP,KAnCiB;;AAAA,SAoClBoB,YApCkB,GAoCFT,KAAD,IAAS;AACpBZ,MAAAA,UAAU,GAAGY,KAAb;AACAC,MAAAA,OAAO,CAACC,GAAR,CAAYd,UAAZ;AAEA,WAAKe,QAAL,CAAc;AACVO,QAAAA,SAAS,EAACV;AADA,OAAd;AAGH,KA3CiB;;AAAA,SA6ClBW,WA7CkB,GA6CJ,MAAI;AACdV,MAAAA,OAAO,CAACC,GAAR,CAAYf,UAAZ;AACA,UAAIyB,IAAI,GAAIC,IAAI,CAACC,KAAL,CAAWC,YAAY,CAACC,OAAb,CAAqB,MAArB,CAAX,CAAZ;AACA,UAAIC,MAAM,GAAGJ,IAAI,CAACC,KAAL,CAAWC,YAAY,CAACC,OAAb,CAAqB,QAArB,CAAX,CAAb;AACA,UAAIE,GAAG,GAAI,yCAAX;AACAjB,MAAAA,OAAO,CAACC,GAAR,CAAYd,UAAZ;AAEA,UAAI+B,IAAI,GAAG;AACH/B,QAAAA,UAAU,EAACA,UADR;AAEHgC,QAAAA,OAAO,EAACR,IAAI,CAACS,MAFV;AAGHC,QAAAA,UAAU,EAACL,MAAM,CAACM,SAHf;AAIHpC,QAAAA,UAAU,EAACA,UAJR;AAKHqC,QAAAA,OAAO,EAAC;AALL,OAAX;AAQAvB,MAAAA,OAAO,CAACC,GAAR,CAAYiB,IAAZ;AACAlC,MAAAA,KAAK,CAACwC,IAAN,CAAWP,GAAX,EAAgBC,IAAhB,EAAsBO,IAAtB,CAA4BC,GAAD,IAAO;AAC3B1B,QAAAA,OAAO,CAACC,GAAR,CAAYyB,GAAG,CAACR,IAAhB;AACH7B,QAAAA,UAAU,GAAGqC,GAAG,CAACR,IAAJ,CAAS7B,UAAtB;AACAW,QAAAA,OAAO,CAACC,GAAR,CAAYZ,UAAZ;AACA,aAAKsC,UAAL;AAEH,OAND;AAQH,KArEiB;;AAAA,SA0ElBA,UA1EkB,GA0EN,MAAI;AACZ3B,MAAAA,OAAO,CAACC,GAAR,CAAY,aAAZ;AAEA,UAAIgB,GAAG,GAAI,wCAAwC,kBAAnD;AACA,UAAIC,IAAI,GAAG;AACPhC,QAAAA,UAAU,EAAEA,UAAU,GAAC;AADhB,OAAX;AAGAF,MAAAA,KAAK,CAAC4C,GAAN,CAAUX,GAAV,EAAeQ,IAAf,CAAqBC,GAAD,IAAO;AACvB;AACA,aAAK,IAAIG,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGH,GAAG,CAACR,IAAJ,CAASY,MAA7B,EAAqCD,CAAC,EAAtC,EAA0C;AACtCzC,UAAAA,MAAM,CAAC2C,IAAP,CAAY;AACRR,YAAAA,OAAO,EAAGG,GAAG,CAACR,IAAJ,CAASW,CAAT,EAAYN,OADd;AAERS,YAAAA,SAAS,EAAGN,GAAG,CAACR,IAAJ,CAASW,CAAT,EAAYG,SAFhB;AAGRC,YAAAA,UAAU,EAAGP,GAAG,CAACR,IAAJ,CAASW,CAAT,EAAYI,UAHjB;AAIR1B,YAAAA,QAAQ,EAAC;AAJD,WAAZ;AAOA,eAAKL,QAAL,CAAc;AACVgC,YAAAA,KAAK,EAAE9C,MAAM,CAAC+C,GAAP,CAAW,CAAC/C,MAAD,EAAQgD,KAAR,KACd,oBAAC,IAAD;AAAM,cAAA,MAAM,EAAIhD,MAAM,CAACmC,OAAvB;AAAgC,cAAA,KAAK,EAAInC,MAAM,CAAC6C,UAAhD;AAA4D,cAAA,WAAW,EAAI7C,MAAM,CAAC4C,SAAlF;AAA8F,cAAA,MAAM,EAAI,KAAK3B,MAA7G;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cADG;AADG,WAAd;AAKH;AACJ,OAhBD;AAkBA,WAAKgC,YAAL;AACA,WAAKC,WAAL;AAEH,KAtGiB;;AAAA,SAwGlBC,UAxGkB,GAwGL,MAAI,CAGhB,CA3GiB;;AAAA,SA8GlBC,UA9GkB,GA8GL,MAAI,CAEhB,CAhHiB;;AAAA,SAmHlBC,MAnHkB,GAmHR,MAAI;AACVzC,MAAAA,OAAO,CAACC,GAAR,CAAYX,QAAZ;AACAG,MAAAA,cAAc;AACd,UAAIkB,IAAI,GAAIC,IAAI,CAACC,KAAL,CAAWC,YAAY,CAACC,OAAb,CAAqB,MAArB,CAAX,CAAZ;AACA,UAAI2B,SAAS,GAAG,6CAAhB;AAEA,UAAGjD,cAAc,GAAC,CAAlB,EACAL,MAAM,CAAC+C,GAAP,CAAW,CAACQ,IAAD,EAAOP,KAAP,KAAe;AACtB,YAAIlB,IAAI,GAAG;AACP5B,UAAAA,QAAQ,EAACA,QADF;AAEP6B,UAAAA,OAAO,EAACR,IAAI,CAACS,MAFN;AAGPlC,UAAAA,UAAU,EAACA,UAHJ;AAIPqC,UAAAA,OAAO,EAAEa,KAAK,GAAC;AAJR,SAAX;AAMApD,QAAAA,KAAK,CAACwC,IAAN,CAAWkB,SAAX,EAAqBxB,IAArB,EAA2BO,IAA3B,CAAiCC,GAAD,IAAO;AACnC1B,UAAAA,OAAO,CAACC,GAAR,CAAYyB,GAAG,CAACR,IAAhB;AACH,SAFD;AAGF,OAVF;AAcC,WAAKhB,QAAL,CAAc;AACV0C,QAAAA,QAAQ,EAACxD,MAAM,CAAC+C,GAAP,CAAW,CAACQ,IAAD,EAAMP,KAAN,KAChB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAAMO,IAAI,CAACX,SAAX,QAAwBW,IAAI,CAACpC,QAA7B,CADK;AADC,OAAd;AAKA,UAAIU,GAAG,GAAI,0CAAX,CA1BS,CA2BV;;AACC,UAAI4B,IAAI,GAAI,yCAAZ;AACA,UAAI3B,IAAI,GAAG;AACT7B,QAAAA,UAAU,EAACA;AADF,OAAX;AAIA,UAAIyD,IAAI,GAAG,4CAAX;AAEA9D,MAAAA,KAAK,CAACwC,IAAN,CAAWqB,IAAX,EAAiB3B,IAAjB,EAAuBO,IAAvB,CAA6BC,GAAD,IAAO;AAC1BpC,QAAAA,QAAQ,GAAIoC,GAAG,CAACR,IAAJ,CAAS,CAAT,EAAY5B,QAAxB;AAEAF,QAAAA,MAAM,CAAC+C,GAAP,CAAW,CAACQ,IAAD,EAAOP,KAAP,KAAe;AACxB,cAAIlB,IAAI,GAAG;AACP5B,YAAAA,QAAQ,EAACA,QADF;AAEP6B,YAAAA,OAAO,EAACR,IAAI,CAACS,MAFN;AAGPlC,YAAAA,UAAU,EAACA,UAHJ;AAIPqC,YAAAA,OAAO,EAAEa,KAAK,GAAC,CAJR;AAKP7B,YAAAA,QAAQ,EAACoC,IAAI,CAACpC;AALP,WAAX;AAOAvB,UAAAA,KAAK,CAACwC,IAAN,CAAWP,GAAX,EAAeC,IAAf,EAAqBO,IAArB,CAA2BC,GAAD,IAAO;AAC7B1B,YAAAA,OAAO,CAACC,GAAR,CAAYyB,GAAG,CAACR,IAAhB;AACH,WAFD;AAGF,SAXA;AAcR,OAjBD;AAoBJ,KA1KiB;;AAAA,SA6KlBmB,YA7KkB,GA6KH,MAAI;AACf;AACA;AACA;AACA9C,MAAAA,OAAO,GAAG,EAAV;AACA,UAAI0B,GAAG,GAAI,uCAAX;AACA,UAAII,UAAU,GAAGT,IAAI,CAACC,KAAL,CAAWC,YAAY,CAACC,OAAb,CAAqB,QAArB,CAAX,EAA2CO,SAA5D;AACA,UAAIJ,IAAI,GAAG;AACPG,QAAAA,UAAU,EAACA;AADJ,OAAX;AAGArB,MAAAA,OAAO,CAACC,GAAR,CAAYoB,UAAZ;AACArC,MAAAA,KAAK,CAACwC,IAAN,CAAWP,GAAX,EAAgBC,IAAhB,EAAsBO,IAAtB,CAA4BC,GAAD,IAAO;AAC9B1B,QAAAA,OAAO,CAACC,GAAR,CAAYyB,GAAZ;AACE,YAAIqB,QAAQ,GAAGrB,GAAG,CAACR,IAAJ,CAAS6B,QAAxB;AACA,YAAI9B,GAAG,GAAI,sCAAX;AACA,YAAIC,IAAI,GAAG;AACP6B,UAAAA,QAAQ,EAACA;AADF,SAAX;AAGA/C,QAAAA,OAAO,CAACC,GAAR,CAAY8C,QAAZ;AACA/D,QAAAA,KAAK,CAACwC,IAAN,CAAWP,GAAX,EAAiBC,IAAjB,EAAuBO,IAAvB,CAA6BC,GAAD,IAAO;AACjC1B,UAAAA,OAAO,CAACC,GAAR,CAAYyB,GAAG,CAACR,IAAhB;;AACA,eAAK,IAAIW,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGH,GAAG,CAACR,IAAJ,CAASY,MAA7B,EAAqCD,CAAC,EAAtC,EAA0C;AACtCtC,YAAAA,OAAO,CAACwC,IAAR,CAAa;AACTiB,cAAAA,SAAS,EAAGtB,GAAG,CAACR,IAAJ,CAASW,CAAT,EAAYmB;AADf,aAAb;AAIA,iBAAK9C,QAAL,CAAc;AACVX,cAAAA,OAAO,EAACA,OAAO,CAAC4C,GAAR,CAAY,CAACc,MAAD,EAAQb,KAAR,KAChB,oBAAC,MAAD;AAAQ,gBAAA,QAAQ,EAAIa,MAAM,CAACD,SAA3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBADI;AADE,aAAd;AAKH;AACF,SAbD;AAcL,OAtBD;AAwBH,KAhNiB;;AAAA,SAiNlBE,UAjNkB,GAiNN,MAAI;AACZ,WAAKb,YAAL;AACH,KAnNiB;;AAAA,SAqNlBc,eArNkB,GAqND,MAAI;AACjB,WAAKb,WAAL;AACH,KAvNiB;;AAAA,SAwNlBA,WAxNkB,GAwNJ,MAAI;AAEd9C,MAAAA,MAAM,GAAE,EAAR;AACAQ,MAAAA,OAAO,CAACC,GAAR,CAAY,aAAZ;AACA,UAAI4C,IAAI,GAAI,yCAAZ;AACA,UAAI3B,IAAI,GAAG;AACT7B,QAAAA,UAAU,EAACA;AADF,OAAX;AAIAW,MAAAA,OAAO,CAACC,GAAR,CAAYiB,IAAZ;AAEAlC,MAAAA,KAAK,CAACwC,IAAN,CAAWqB,IAAX,EAAiB3B,IAAjB,EAAuBO,IAAvB,CAA6BC,GAAD,IAAO;AAC/B1B,QAAAA,OAAO,CAACC,GAAR,CAAYyB,GAAG,CAACR,IAAhB;AACA5B,QAAAA,QAAQ,GAAIoC,GAAG,CAACR,IAAJ,CAAS,CAAT,EAAY5B,QAAxB;AACAU,QAAAA,OAAO,CAACC,GAAR,CAAYX,QAAZ;AACA,YAAI2B,GAAG,GAAI,qCAAX;AACA,YAAIC,IAAI,GAAG;AACP5B,UAAAA,QAAQ,EAACA;AADF,SAAX;AAGAN,QAAAA,KAAK,CAACwC,IAAN,CAAWP,GAAX,EAAeC,IAAf,EAAqBO,IAArB,CAA2BC,GAAD,IAAO;AAC7B1B,UAAAA,OAAO,CAACC,GAAR,CAAYyB,GAAG,CAACR,IAAhB;;AAEA,eAAK,IAAIW,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGH,GAAG,CAACR,IAAJ,CAASY,MAA7B,EAAqCD,CAAC,EAAtC,EAA0C;AACtCrC,YAAAA,MAAM,CAACuC,IAAP,CAAY;AACRZ,cAAAA,OAAO,EAACO,GAAG,CAACR,IAAJ,CAASW,CAAT,EAAYV,OADZ;AAERI,cAAAA,OAAO,EAACG,GAAG,CAACR,IAAJ,CAASW,CAAT,EAAYN,OAFZ;AAGRhB,cAAAA,QAAQ,EAACmB,GAAG,CAACR,IAAJ,CAASW,CAAT,EAAYtB;AAHb,aAAZ;AAMA,iBAAKL,QAAL,CAAc;AACVkD,cAAAA,SAAS,EAAC5D,MAAM,CAAC2C,GAAP,CAAW,CAACkB,KAAD,EAAOjB,KAAP,KACjB,oBAAC,KAAD;AAAO,gBAAA,OAAO,EAAIiB,KAAK,CAAClC,OAAxB;AAAiC,gBAAA,OAAO,EAAEkC,KAAK,CAAC9B,OAAhD;AAAyD,gBAAA,QAAQ,EAAE8B,KAAK,CAAC9C,QAAzE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBADM;AADA,aAAd;AAKH;AACJ,SAhBD;AAiBH,OAzBD;AA0BH,KA7PiB;;AAAA,SA8PnB+C,UA9PmB,GA8PN,MAAI;AACb,UAAIrC,GAAG,GAAG,sCAAV;AACA,UAAIN,IAAI,GAAIC,IAAI,CAACC,KAAL,CAAWC,YAAY,CAACC,OAAb,CAAqB,MAArB,CAAX,CAAZ;AACA,UAAIG,IAAI,GAAI;AACR8B,QAAAA,SAAS,EAACrC,IAAI,CAACS;AADP,OAAZ;AAGApC,MAAAA,KAAK,CAACuE,MAAN;AACH,KArQkB;;AAEZvD,IAAAA,OAAO,CAACC,GAAR,CAAYJ,KAAZ;AACF,SAAKO,KAAL,GAAa;AACTD,MAAAA,SAAS,EAAC,EADD;AAETM,MAAAA,SAAS,EAAC,EAFD;AAGTmC,MAAAA,QAAQ,EAAC,EAHA;AAITrD,MAAAA,OAAO,EAAC,EAJC;AAKT6D,MAAAA,SAAS,EAAC;AALD,KAAb;AAOH;;AAEDI,EAAAA,iBAAiB,GAAE,CAElB;;AAwPDC,EAAAA,MAAM,GAAE;AACJ;AACA,WACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACA,oBAAC,MAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI,oBAAC,KAAD;AAAO,MAAA,IAAI,EAAC,YAAZ;AAAyB,MAAA,KAAK,MAA9B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACA,oBAAC,aAAD;AAAe,MAAA,YAAY,EAAI,KAAK3D,YAApC;AAAkD,MAAA,YAAY,EAAI,KAAKU,YAAvE;AAAsF,MAAA,WAAW,EAAI,KAAKE,WAA1G;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADA,EAEG,KAAKN,KAAL,CAAWD,SAAZ,GAAuB,KAAKC,KAAL,CAAWD,SAAlC,GAA4C,EAF9C,EAGG,KAAKC,KAAL,CAAWK,SAAZ,GAAuB,KAAKL,KAAL,CAAWK,SAAlC,GAA4C,EAH9C,CADJ,EAOA,oBAAC,KAAD;AAAO,MAAA,IAAI,EAAG,kBAAd;AAAiC,MAAA,KAAK,MAAtC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAEM,KAAKZ,KAAL,CAAW6D,SAAZ,GAAwB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gCAA2B,KAAK7D,KAAL,CAAW6D,SAAtC,CAAxB,GAAgF,EAFrF,EAII;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iCAA4BvE,UAA5B,CAJJ,EAMI;AAAK,MAAA,SAAS,EAAEX,MAAM,CAACoE,QAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,2BAEsB,KAAKxC,KAAL,CAAWwC,QAFjC,CANJ,EAWG;AAAK,MAAA,SAAS,EAAGpE,MAAM,CAACe,OAAxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACA;AAAQ,MAAA,SAAS,EAAGf,MAAM,CAACiE,MAA3B;AAAmC,MAAA,OAAO,EAAG,KAAKS,UAAlD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBADA,EAGC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBAHD,EAIC,KAAK9C,KAAL,CAAWb,OAJZ,CAXH,EAiBI;AAAK,MAAA,SAAS,EAAEf,MAAM,CAACmF,QAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,4CAEG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACK,KAAKvD,KAAL,CAAW8B,KADhB,CAFH,CAjBJ,EAwBG;AAAQ,MAAA,SAAS,EAAG1D,MAAM,CAACiE,MAA3B;AAAmC,MAAA,OAAO,EAAG,KAAKA,MAAlD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,yBAxBH,EAyBG;AAAK,MAAA,SAAS,EAAEjE,MAAM,CAAC4E,SAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACD;AAAQ,MAAA,SAAS,EAAG5E,MAAM,CAACiE,MAA3B;AAAmC,MAAA,OAAO,EAAG,KAAKU,eAAlD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBADC,2BAGA,KAAK/C,KAAL,CAAWgD,SAHX,CAzBH,CAPA,EAwCE;AAAQ,MAAA,SAAS,EAAG5E,MAAM,CAACiE,MAA3B;AAAmC,MAAA,OAAO,EAAG,KAAKa,UAAlD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAxCF,CADA,CADJ;AAkDH;;AA3TiD","sourcesContent":["import React from 'react'\r\nimport Styles from './main.module.css'\r\nimport ChooseCanteen from '../canteens/chooseCanteen';\r\nimport {BrowserRouter as Router  , Route} from 'react-router-dom'\r\nimport Item from '../items/index'\r\nimport Member from '../member/index'\r\nimport Order from '../order/index'\r\nvar axios  = require('axios')\r\n\r\nvar canteen_id = '' ;\r\nvar order_name = '';\r\nvar object = [];\r\nvar order_hash = ''\r\nvar order_id = ''\r\nvar members = [];\r\nvar orders = []\r\nvar numberOfSubmit = 0;\r\n// var orderHas\r\nexport default class OrderPage extends React.Component{\r\n    constructor(props){\r\n        super();\r\n          console.log(props)\r\n        this.state = {\r\n            canteenId:'',\r\n            orderName:'',\r\n            myorders:'',\r\n            members:'',\r\n            orderList:''\r\n        }\r\n    }\r\n\r\n    componentDidMount(){\r\n\r\n    }\r\n\r\n    setCanteenId = (value)=>{\r\n\r\n        canteen_id = value;\r\n        console.log(value)\r\n        this.setState({\r\n            canteenId:value\r\n        })\r\n\r\n        console.log(this.state.canteenId)\r\n\r\n    }\r\n\r\n    update = (update, itemId)=>{\r\n           \r\n\r\n\r\n            object[itemId-1].quantity = update + 1 ;\r\n\r\n            console.log(object)\r\n    }\r\n    setOrderName = (value)=>{\r\n        order_name = value;\r\n        console.log(order_name)\r\n\r\n        this.setState({\r\n            orderName:value\r\n        })\r\n    }\r\n\r\n    createOrder = ()=>{\r\n        console.log(canteen_id)\r\n        let user  = JSON.parse(localStorage.getItem('user'));\r\n        let groups = JSON.parse(localStorage.getItem('groups'));\r\n        let url  = \"http://localhost:3005/api/orders/create\";\r\n        console.log(order_name);\r\n        \r\n        let data = {\r\n                order_name:order_name,\r\n                user_id:user.userId,\r\n                group_code:groups.groupcode,\r\n                canteen_id:canteen_id,\r\n                item_id:0\r\n        }\r\n\r\n        console.log(data)\r\n        axios.post(url, data).then((res)=>{\r\n               console.log(res.data)\r\n            order_hash = res.data.order_hash;\r\n            console.log(order_hash)\r\n            this.fetchItems();\r\n\r\n        })\r\n\r\n    }\r\n\r\n   \r\n\r\n\r\n    fetchItems =()=>{\r\n        console.log(\"fetch items\")\r\n\r\n        let url  = \"http://localhost:3005/api/canteens/\" + \"rajeev_item_list\";\r\n        let data = {\r\n            canteen_id:(canteen_id+1)\r\n        }\r\n        axios.get(url).then((res)=>{\r\n            // console.log(res);\r\n            for (let i = 0; i < res.data.length; i++) {\r\n                object.push({\r\n                    item_id : res.data[i].item_id ,\r\n                    item_name : res.data[i].item_name,\r\n                    item_price : res.data[i].item_price,\r\n                    quantity:0\r\n                });\r\n               \r\n                this.setState({\r\n                    items: object.map((object,index)=>(\r\n                        <Item itemId = {object.item_id} price = {object.item_price} description = {object.item_name}  update = {this.update}></Item>\r\n                    ))\r\n                })\r\n            }\r\n        })\r\n\r\n        this.fetchMembers();\r\n        this.fetchOrders();\r\n\r\n    }\r\n\r\n    getOrderId = ()=>{\r\n        \r\n       \r\n    }\r\n\r\n\r\n    deleteItem = ()=>{\r\n      \r\n    }\r\n\r\n\r\n    submit  = ()=>{\r\n        console.log(order_id);\r\n        numberOfSubmit++;\r\n        let user =  JSON.parse(localStorage.getItem('user'));\r\n        let deleteurl = \"http://localhost:3005/api/orders/deleteitem\";\r\n\r\n        if(numberOfSubmit>1)\r\n        object.map((item, index)=>{\r\n            let data = {\r\n                order_id:order_id,\r\n                user_id:user.userId,\r\n                canteen_id:canteen_id,\r\n                item_id:(index+1),\r\n            } ;\r\n            axios.post(deleteurl,data).then((res)=>{\r\n                console.log(res.data);\r\n            })\r\n         })\r\n\r\n      \r\n\r\n         this.setState({\r\n             myorders:object.map((item,index)=>(\r\n                 <li> {item.item_name} :{item.quantity}</li>\r\n             ))\r\n         });\r\n         let url  = \"http://localhost:3005/api/orders/additem\" ;\r\n        //  this.getOrderId();\r\n         let url2  = \"http://localhost:3005/api/order/orderId\";\r\n         let data = {\r\n           order_hash:order_hash\r\n \r\n         }\r\n         let url3 = \"http://localhost:3005/api/orders/delete//'\"\r\n \r\n         axios.post(url2, data).then((res)=>{\r\n                  order_id  = res.data[0].order_id;\r\n\r\n                  object.map((item, index)=>{\r\n                    let data = {\r\n                        order_id:order_id,\r\n                        user_id:user.userId,\r\n                        canteen_id:canteen_id,\r\n                        item_id:(index+1),\r\n                        quantity:item.quantity\r\n                    } ;\r\n                    axios.post(url,data).then((res)=>{\r\n                        console.log(res.data);\r\n                    })\r\n                 })\r\n        \r\n \r\n         })\r\n        \r\n        \r\n    }\r\n\r\n\r\n    fetchMembers = ()=>{\r\n        // this.setState({\r\n        //     members:''\r\n        // })\r\n        members = [];\r\n        let url  = \"http://localhost:3005/api/getgroupid2\";\r\n        let group_code = JSON.parse(localStorage.getItem('groups')).groupcode;\r\n        let data = {\r\n            group_code:group_code\r\n        }\r\n        console.log(group_code)\r\n        axios.post(url, data).then((res)=>{\r\n            console.log(res)\r\n              let group_id = res.data.group_id;\r\n              let url  = \"http://localhost:3005/api/getmembers\";\r\n              let data = {\r\n                  group_id:group_id\r\n              }\r\n              console.log(group_id)\r\n              axios.post(url , data).then((res)=>{\r\n                console.log(res.data)\r\n                for (let i = 0; i < res.data.length; i++) {\r\n                    members.push({\r\n                        member_id : res.data[i].member_id ,\r\n                    });\r\n                   \r\n                    this.setState({\r\n                        members:members.map((member,index)=>(\r\n                            <Member memberId = {member.member_id}></Member>\r\n                        ))\r\n                    })\r\n                }\r\n              })\r\n        })\r\n        \r\n    }\r\n    updateList =()=>{\r\n        this.fetchMembers();\r\n    }\r\n\r\n    updateOrderList =()=>{\r\n        this.fetchOrders();\r\n    }\r\n    fetchOrders = ()=>{\r\n        \r\n        orders =[];\r\n        console.log(\"fetch order\"); \r\n        let url2  = \"http://localhost:3005/api/order/orderId\";\r\n        let data = {\r\n          order_hash:order_hash\r\n\r\n        }\r\n        console.log(data)\r\n           \r\n        axios.post(url2, data).then((res)=>{\r\n            console.log(res.data)\r\n            order_id  = res.data[0].order_id;\r\n            console.log(order_id)\r\n            let url  = \"http://localhost:3005/api/getorders\";\r\n            let data = {\r\n                order_id:order_id\r\n            } \r\n            axios.post(url,data).then((res)=>{\r\n                console.log(res.data)\r\n\r\n                for (let i = 0; i < res.data.length; i++) {\r\n                    orders.push({\r\n                        user_id:res.data[i].user_id ,\r\n                        item_id:res.data[i].item_id,\r\n                        quantity:res.data[i].quantity\r\n                    });\r\n                   \r\n                    this.setState({\r\n                        orderList:orders.map((order,index)=>(\r\n                            <Order user_id = {order.user_id} item_id={order.item_id} quantity={order.quantity}></Order>\r\n                        ))\r\n                    })\r\n                }\r\n            })\r\n        })\r\n    }\r\n   leaveGroup = ()=>{\r\n       let url = \"http://localhost:3005/api/leavegroup\" ;\r\n       let user =  JSON.parse(localStorage.getItem('user'));\r\n       let data  = {\r\n           member_id:user.userId,\r\n       }\r\n       axios.posttt\r\n   }\r\n    render(){\r\n        // console.log(this.state.members)\r\n        return (\r\n            <div>\r\n            <Router>\r\n                <Route path=\"/orderPage\" exact>\r\n                <ChooseCanteen setCanteenId = {this.setCanteenId} setOrderName = {this.setOrderName}  createOrder = {this.createOrder}></ChooseCanteen>\r\n                { (this.state.canteenId)?this.state.canteenId:''}\r\n                { (this.state.orderName)?this.state.orderName:''}\r\n\r\n            </Route>\r\n            <Route path = \"/orderPage/order\" exact>\r\n\r\n               { (this.props.groupCode)?(<div>YOUR GROUP CODE IS : {this.props.groupCode}</div>):''}\r\n               \r\n                <div> your ORDER NAME IS : {order_name}</div>\r\n             \r\n                <div className={Styles.myorders}>\r\n                  YOUR final Order\r\n                                     {this.state.myorders}\r\n               </div>\r\n\r\n               <div className ={Styles.members}>\r\n               <button className ={Styles.submit} onClick= {this.updateList}>update</button>\r\n\r\n                <h3>Members List:</h3>\r\n               {this.state.members}\r\n            </div>\r\n                <div className={Styles.itemList}>\r\n                    :::::::CHOOSE YOUR ITEMS ::::::::\r\n                   <ul>\r\n                       {this.state.items}\r\n                   </ul>\r\n                  \r\n               </div>  \r\n               <button className ={Styles.submit} onClick= {this.submit}>SUBMIT MY ORDER</button>\r\n               <div className={Styles.orderList}>\r\n              <button className ={Styles.submit} onClick= {this.updateOrderList}>update</button>\r\n                    ::::ALL ORDERS ::::::\r\n              {this.state.orderList}\r\n              </div>\r\n \r\n            </Route>\r\n          \r\n              <button className ={Styles.submit} onClick= {this.leaveGroup}>update</button>\r\n          \r\n\r\n\r\n            </Router>\r\n            \r\n            </div>\r\n        )\r\n    } \r\n}"]},"metadata":{},"sourceType":"module"}